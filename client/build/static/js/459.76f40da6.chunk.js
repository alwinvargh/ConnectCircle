"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[459],{8459:(e,r,t)=>{t.r(r),t.d(r,{default:()=>f});var a=t(5043),s=t(3216),l=t(9456),n=t(4248),i=t(7796),d=t(7805),o=t(2127),c=t(221),m=t(579);const x=e=>{let{activeTab:r,handleTabClick:t}=e;const x=(0,s.Zp)(),u=(0,l.wA)(),[p,h]=(0,a.useState)(!1);return(0,m.jsx)("div",{className:"border-b border-gray-200 sticky top-0 left-0 z-30 bg-white rounded-md",children:(0,m.jsxs)("ul",{className:"flex flex-wrap -mb-px text-sm font-medium text-center text-gray-500",children:[(0,m.jsx)("li",{className:"mr-2 flex items-center",children:(0,m.jsxs)("span",{className:"cursor-pointer inline-flex items-center px-2 py-2 border-b-2 rounded-t-lg "+("logs"===r?"border-purple-500 bg-purple-700 rounded-md text-white":"border-transparent hover:text-gray-600 hover:border-gray-300"),onClick:()=>t("logs"),children:[(0,m.jsx)(o.ICT,{className:"mr-1"}),"Logs"]})}),(0,m.jsx)("li",{className:"mr-2 flex items-center",children:(0,m.jsxs)("span",{className:"cursor-pointer inline-flex items-center px-2 py-2 border-b-2 rounded-t-lg "+("settings"===r?"border-purple-500 bg-purple-700 rounded-md text-white":"border-transparent hover:text-gray-600 hover:border-gray-300"),onClick:()=>t("settings"),children:[(0,m.jsx)(c.GD,{className:"mr-1"}),"Settings"]})}),(0,m.jsx)("li",{className:"mr-2 flex items-center",children:(0,m.jsxs)("span",{className:"cursor-pointer inline-flex items-center px-2 py-2 border-b-2 rounded-t-lg "+("Community Management"===r?"border-blue-500 bg-purple-700 rounded-md text-white":"border-transparent hover:text-gray-600 hover:border-gray-300"),onClick:()=>t("Community Management"),children:[(0,m.jsx)(o.jh0,{className:"mr-1"}),"Community Management"]})}),(0,m.jsx)("li",{className:"mr-2 flex items-center",children:(0,m.jsxs)("span",{className:"cursor-pointer inline-flex items-center px-2 py-2 border-b-2 rounded-t-md "+("logout"===r?"border-purple-500 bg-purple-700 rounded-md text-white":"border-transparent hover:text-red-600 hover:border-red-600"),onClick:async()=>{h(!0),await u((0,n.Zm)()).then((()=>{x("/admin/signin")})),h(!1)},children:[(0,m.jsx)(d.AMx,{className:"mr-1"}),(0,m.jsx)("span",{className:""+("logout"===r?"group-hover:text-gray-500":"group-hover:text-red-600"),children:p?(0,m.jsx)(i.A,{loadingText:"Logging out..."}):"Logout"})]})})]})})},u=()=>{const[e,r]=(0,a.useState)((new Date).toLocaleString());(0,a.useEffect)((()=>{const e=setInterval((()=>{r((new Date).toLocaleString())}),1e3);return()=>clearInterval(e)}),[]);const t=new Date(e),s=t.toLocaleDateString("en-US",{weekday:"long"}),l=t.toLocaleDateString("en-US",{month:"long"}),n=t.toLocaleDateString("en-US",{day:"numeric"}),i=t.toLocaleDateString("en-US",{year:"numeric"}),d=`${t.getHours()%12||12}:${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")} ${t.getHours()>=12?"PM":"AM"}`;return(0,m.jsx)("div",{className:"text-sm text-gray-800 mt-1",children:`${s}, ${l} ${n}, ${i} ${d}`})};var p=t(9719),h=t(243);const g=()=>{const[e,r]=(0,a.useState)(!0),[t,s]=(0,a.useState)(!1),d=(0,l.wA)(),o=(0,l.d4)((e=>{var r;return null===(r=e.admin)||void 0===r?void 0:r.logs})),c=async()=>{try{r(!0),await d((0,n.C1)())}finally{r(!1)}};return(0,a.useEffect)((()=>{c()}),[null===o||void 0===o?void 0:o.length]),e||!o?(0,m.jsx)("div",{className:"flex items-center justify-center mt-5",children:(0,m.jsx)(p.A,{})}):(0,m.jsx)("div",{className:"bg-white flex flex-col items-center justify-center mt-3 rounded-md",children:(0,m.jsxs)("div",{className:"p-4 shadow-md rounded relative xl:min-w-[1200px] lg:min-w-[1000px] md:min-w-[800px]",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,m.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"User Activity Logs"}),(0,m.jsx)(u,{})]}),(0,m.jsxs)("div",{className:"flex justify-between items-center mb-4 border-b border-gray-200 pb-2",children:[(0,m.jsx)("div",{className:"text-sm italic text-gray-600",children:`Showing ${o.length} items from the last 7 days`}),(0,m.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,m.jsx)("button",{onClick:async()=>{try{r(!0),await c()}catch(e){}},children:(0,m.jsx)(h.l_n,{})}),(0,m.jsx)("button",{className:`bg-purple-500 text-white text-sm py-2 px-4 rounded hover:bg-purple-700 ${t?"opacity-50 cursor-not-allowed":""} ${0===o.length?"hidden":""}`,onClick:async()=>{try{s(!0),await d((0,n.JT)())}finally{s(!1)}},disabled:t||0===o.length,children:t?(0,m.jsx)(i.A,{loadingText:"Clearing..."}):"Clear Logs"})]})]}),e?null:0===o.length?(0,m.jsx)("div",{className:"text-gray-500 text-lg",children:"No logs found"}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"h-[430px] relative overflow-auto",children:(0,m.jsxs)("div",{className:"w-full rounded",children:[(0,m.jsxs)("div",{className:"grid grid-cols-5 gap-5 items-center border-b py-2 font-semibold text-gray-800",children:[(0,m.jsx)("p",{className:"text-center",children:"Timestamp"}),(0,m.jsx)("p",{children:"Message"}),(0,m.jsx)("p",{children:"Email Used"}),(0,m.jsx)("p",{children:"Level"}),(0,m.jsx)("p",{children:"Context Data"})]}),o.map((e=>(0,m.jsxs)("div",{className:"grid grid-cols-5 gap-5 items-center border-b py-2 text-sm text-gray-700",children:[(0,m.jsxs)("span",{className:"flex-col justify-center items-center text-center font-mono",children:[(0,m.jsx)("p",{children:e.relativeTimestamp}),(0,m.jsx)("p",{className:"text-xs",children:e.formattedTimestamp})]}),(0,m.jsxs)("td",{className:""+("info"===e.level?"text-blue-500":"warn"===e.level?"text-orange-500":"error"===e.level?"text-red-600":""),children:[(0,m.jsxs)("span",{className:"capitalize",children:[e.type,": "]}),(0,m.jsx)("span",{children:e.message})]}),(0,m.jsx)("p",{children:e.email}),(0,m.jsx)("td",{className:"",children:(0,m.jsx)("span",{className:"rounded-full px-2 py-1 text-sm font-semibold "+("error"===e.level?"bg-red-500 text-white":"warn"===e.level?"bg-orange-500 text-white":"bg-blue-500 text-white"),children:e.level})}),(0,m.jsx)("td",{className:"",children:(0,m.jsx)("ul",{className:"list-disc list-inside",children:e.contextData&&Object.entries(e.contextData).map((e=>{let[r,t]=e;return(0,m.jsxs)("li",{children:[(0,m.jsxs)("span",{className:"font-medium text-blue-500",children:[r,":"," "]}),t]},r)}))})})]},e._id)))]})}),(0,m.jsx)("div",{className:"flex justify-center text-sm italic text-gray-600 mt-2",children:"logs are automatically deleted after 7 days"})]})]})})},y=()=>{const e=(0,l.wA)(),[r,t]=(0,a.useState)(!0),[s,i]=(0,a.useState)(!1),[d,o]=(0,a.useState)(!1),c=(0,l.d4)((e=>{var r;return null===(r=e.admin)||void 0===r?void 0:r.servicePreferences})),[x,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(""),[g,y]=(0,a.useState)(0);(0,a.useEffect)((()=>{e((0,n.C$)())}),[e]),(0,a.useEffect)((()=>{c&&(u(c.usePerspectiveAPI),h(c.categoryFilteringServiceProvider),y(c.categoryFilteringRequestTimeout),t(!1))}),[c]);return r||!c?(0,m.jsx)("div",{children:"Loading..."}):(0,m.jsxs)("div",{className:"p-5 w-full border rounded-md bg-white mt-3",children:[(0,m.jsx)("h2",{className:"font-semibold mb-4 border-b pb-2 text-center text-gray-700",children:"Service Preferences"}),d&&(0,m.jsx)("div",{className:"bg-green-100 text-green-800 p-2 mb-4 rounded",children:"Service Preferences updated successfully!"}),(0,m.jsxs)("div",{className:"flex items-center mb-4",children:[(0,m.jsx)("div",{children:"Use Perspective API for content moderation"}),(0,m.jsx)("div",{className:"ml-auto",children:(0,m.jsx)("input",{className:"w-5 h-5 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500 dark:focus:ring-purple-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",type:"checkbox",checked:x,onChange:e=>u(e.target.checked)})})]}),(0,m.jsxs)("div",{className:"flex items-center mb-4",children:[(0,m.jsx)("div",{children:"Category filtering service provider"}),(0,m.jsx)("div",{className:"ml-auto",children:(0,m.jsxs)("select",{className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-purple-500 focus:border-purple-500 block w-full p-2.5 ",value:p,onChange:e=>h(e.target.value),children:[(0,m.jsx)("option",{value:"",children:"Select a provider"}),(0,m.jsx)("option",{value:"TextRazor",children:"TextRazor"}),(0,m.jsx)("option",{value:"InterfaceAPI",children:"InterfaceAPI"}),(0,m.jsx)("option",{value:"ClassifierAPI",children:"ClassifierAPI"}),(0,m.jsx)("option",{value:"disabled",children:"Disabled"})]})})]}),(0,m.jsxs)("div",{className:"flex items-center mb-4",children:[(0,m.jsx)("div",{children:"Category filtering request timeout (ms)"}),(0,m.jsx)("div",{className:"ml-auto",children:(0,m.jsx)("input",{className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-purple-500 focus:border-purple-500 block w-full p-2.5 ",type:"number",value:g,min:0,max:5e5,required:!0,onChange:e=>{y(e.target.value)}})})]}),(0,m.jsx)("div",{className:"flex justify-end",children:(0,m.jsx)("button",{className:"bg-purple-500 text-white px-4 py-2 rounded disabled:opacity-50",onClick:async()=>{i(!0),o(!1);try{await e((0,n.vX)({usePerspectiveAPI:x,categoryFilteringServiceProvider:p,categoryFilteringRequestTimeout:g})),o(!0),setTimeout((()=>{o(!1)}),3e3)}finally{i(!1)}},disabled:s,children:s?"Updating...":"Update"})})]})},b=()=>{var e,r,t,s;const i=(0,l.wA)(),d=(0,l.d4)((e=>{var r;return null===(r=e.admin)||void 0===r?void 0:r.communities})),o=(0,l.d4)((e=>{var r;return null===(r=e.admin)||void 0===r?void 0:r.moderators})),c=(0,l.d4)((e=>{var r;return null===(r=e.admin)||void 0===r?void 0:r.community}));(0,a.useEffect)((()=>{i((0,n.WB)()),i((0,n.vT)())}),[i]);const[x,u]=(0,a.useState)(null),[p,h]=(0,a.useState)(null),[g,y]=(0,a.useState)(null),[b,f]=(0,a.useState)(""),[v,j]=(0,a.useState)(!1),[w,N]=(0,a.useState)(!1);(0,a.useEffect)((()=>{h(c)}),[c]);return d&&o?(0,m.jsxs)("div",{className:"flex gap-2 h-[85vh] w-full mt-3 border rounded-md",children:[(0,m.jsxs)("div",{className:"flex flex-col w-full bg-white shadow-inner rounded-md border-r",children:[(0,m.jsx)("h1",{className:"text-lg font-bold p-4 text-center border-b-2",children:"Communities"}),(0,m.jsx)("div",{className:"flex flex-col overflow-y-auto",children:d.map((e=>(0,m.jsxs)("div",{className:"p-4 cursor-pointer hover:bg-background border-b flex items-center "+((null===x||void 0===x?void 0:x._id)===e._id?"bg-gray-200":""),onClick:()=>(async e=>{u(e),N(!0),await i((0,n.qn)(e._id)),N(!1)})(e),children:[(0,m.jsx)("img",{src:e.banner,alt:e.name,className:"w-10 h-10 rounded-full mr-2 md:mr-4"}),(0,m.jsx)("span",{className:"text-gray-700 text-xs md:text-base",children:e.name})]},e._id)))})]}),(0,m.jsx)("div",{className:"flex flex-col w-full bg-white rounded-md px-5 py-5 border-l",children:w?(0,m.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,m.jsx)("span",{className:"admin-loader"})}):p?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("h1",{className:"font-bold text-lg border-b border-black pb-1 mb-2",children:p.name}),v&&(0,m.jsx)("div",{className:"bg-green-100 text-green-800 p-2 mb-4 rounded",children:"Updating..."}),(0,m.jsxs)("span",{className:"text-sm",children:["Total Moderators: ",p.moderatorCount]}),(0,m.jsxs)("span",{className:"text-sm",children:["Total Members: ",p.memberCount]}),(0,m.jsxs)("div",{className:"flex flex-col md:flex-row gap-5",children:[(0,m.jsxs)("div",{className:"flex flex-col gap-2 w-full md:w-1/2",children:[(0,m.jsx)("h2",{className:"font-medium mb-2",children:"Moderators"}),0===(null===(e=p.moderators)||void 0===e?void 0:e.length)&&(0,m.jsx)("span",{children:"No moderators"}),(0,m.jsx)("div",{className:"flex flex-col",children:null===(r=p.moderators)||void 0===r?void 0:r.map((e=>(0,m.jsxs)("div",{className:"p-2 cursor-pointer border flex flex-col md:flex-row gap-2 justify-between items-center rounded "+(null===g||void 0===g||g._id,e._id,""),onClick:()=>(e=>{y(e)})(e),children:[(0,m.jsx)("span",{className:"font-medium",children:e.name}),(0,m.jsx)("button",{disabled:v,className:" bg-red-500 px-4 py-1 text-sm  text-white rounded hover:bg-red-700 "+(v?"opacity-50 cursor-not-allowed":""),onClick:()=>(async e=>{j(!0),await i((0,n.KX)(p._id,e._id)),await i((0,n.qn)(p._id)),await i((0,n.rb)(p._id,b)),await i((0,n.vT)()),j(!1)})(e),children:"Remove"})]},e._id)))})]}),(0,m.jsxs)("div",{className:"flex flex-col w-full gap-2 md:w-1/2",children:[(0,m.jsx)("h2",{className:"font-medium mb-2",children:"Add Moderator"}),(0,m.jsxs)("div",{className:"flex flex-col gap-2 md:flex-row",children:[(0,m.jsxs)("select",{className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded focus:ring-purple-500 focus:border-purple-500 block w-full p-2.5 ",value:b,onChange:e=>f(e.target.value),children:[(0,m.jsx)("option",{value:"",children:"Select a moderator"}),null===o||void 0===o?void 0:o.map((e=>(0,m.jsx)("option",{value:e._id,children:e.name},e._id)))]}),(0,m.jsx)("button",{disabled:!b||v||(null===(t=p.moderators)||void 0===t?void 0:t.find((e=>e._id===b))),className:"p-2 bg-purple-500 text-white rounded hover:bg-purple-700 "+(!b||v||null!==(s=p.moderators)&&void 0!==s&&s.find((e=>e._id===b))?"opacity-50 cursor-not-allowed":""),onClick:async()=>{j(!0),await i((0,n.rb)(p._id,b)),await i((0,n.qn)(p._id)),await i((0,n.vT)()),f(""),j(!1)},children:"Add"})]})]})]})]}):(0,m.jsx)("div",{className:"flex flex-col items-center justify-center h-full",children:(0,m.jsx)("span",{className:"font-medium text-gray-400",children:"Select a community to view details"})})})]}):(0,m.jsx)("div",{children:"Loading..."})},f=()=>{const e=(0,l.wA)(),r=(0,s.Zp)(),[t,i]=(0,a.useState)("logs"),d=(0,l.d4)((e=>{var r;return null===(r=e.admin)||void 0===r?void 0:r.adminPanelError}));return(0,a.useEffect)((()=>{"Unauthorized"===d&&e((0,n.Zm)()).then((()=>{r("/admin/signin")}))}),[d,e,r]),(0,m.jsxs)("div",{className:"pt-5 max-w-6xl mx-auto flex flex-col justify-center items-center ",children:[(0,m.jsx)(x,{activeTab:t,handleTabClick:e=>{i(e)}}),"logs"===t&&(0,m.jsx)(g,{}),"settings"===t&&(0,m.jsx)(y,{}),"Community Management"===t&&(0,m.jsx)(b,{})]})}},4248:(e,r,t)=>{t.d(r,{rb:()=>p,JT:()=>d,WB:()=>m,qn:()=>x,C1:()=>i,vT:()=>u,C$:()=>o,Zm:()=>n,KX:()=>h,Lz:()=>l,vX:()=>c});var a=t(2247);var s=t(4359);const l=e=>async r=>{try{const{error:t,data:l}=await(async e=>{try{return{error:null,data:(await a.lb.post("/signin",e)).data}}catch(t){return(0,a.hS)(t)}})(e);if(t)throw new Error(t);localStorage.setItem("admin",JSON.stringify(l)),r({type:s.qf})}catch(t){r({type:s.Xm,payload:t.message})}},n=()=>async e=>{try{localStorage.removeItem("admin"),e({type:s.l3})}catch(r){}},i=()=>async e=>{try{const{error:r,data:t}=await(async()=>{try{return{error:null,data:(await a.lb.get("/logs")).data}}catch(r){return(0,a.hS)(r)}})();if(r)throw new Error(r);e({type:s.Ho,payload:t})}catch(r){e({type:s.Sw,payload:r.message})}},d=()=>async e=>{try{const{error:r}=await(async()=>{try{await a.lb.delete("/logs")}catch(r){return(0,a.hS)(r)}})();if(r)throw new Error(r);e({type:s.AJ})}catch(r){e({type:s.PR,payload:r.message})}},o=()=>async e=>{try{const{error:r,data:t}=await(async()=>{try{return{error:null,data:(await a.lb.get("/preferences")).data}}catch(r){return(0,a.hS)(r)}})();if(r)throw new Error(r);e({type:s.Wp,payload:t})}catch(r){e({type:s.Nz,payload:r.message})}},c=e=>async r=>{try{const{error:t}=await(async e=>{try{await a.lb.put("/preferences",e)}catch(t){return(0,a.hS)(t)}})(e);if(t)throw new Error(t);r({type:s.dK})}catch(t){r({type:s.Ek,payload:t.message})}},m=()=>async e=>{try{const{error:r,data:t}=await(async()=>{try{return{error:null,data:(await a.lb.get("/communities")).data}}catch(r){return(0,a.hS)(r)}})();if(r)throw new Error(r);e({type:s.pK,payload:t})}catch(r){e({type:s.YI,payload:r.message})}},x=e=>async r=>{try{const{error:t,data:l}=await(async e=>{try{return{error:null,data:(await a.lb.get(`/community/${e}`)).data}}catch(t){return(0,a.hS)(t)}})(e);if(t)throw new Error(t);r({type:s.rR,payload:l})}catch(t){r({type:s.OF,payload:t.message})}},u=()=>async e=>{try{const{error:r,data:t}=await(async()=>{try{return{error:null,data:(await a.lb.get("/moderators")).data}}catch(r){return(0,a.hS)(r)}})();if(r)throw new Error(r);e({type:s.qK,payload:t})}catch(r){e({type:s.H9,payload:r.message})}},p=(e,r)=>async t=>{try{const{error:l}=await(async(e,r)=>{try{await a.lb.patch("/add-moderators",null,{params:{communityId:e,moderatorId:r}})}catch(l){return(0,a.hS)(l)}})(e,r);if(l)throw new Error(l);t({type:s.G4})}catch(l){t({type:s.JE,payload:l.message})}},h=(e,r)=>async t=>{try{const{error:l}=await(async(e,r)=>{try{await a.lb.patch("/remove-moderators",null,{params:{communityId:e,moderatorId:r}})}catch(l){return(0,a.hS)(l)}})(e,r);if(l)throw new Error(l);t({type:s.lu})}catch(l){t({type:s.Sj,payload:l.message})}}}}]);
//# sourceMappingURL=459.76f40da6.chunk.js.map